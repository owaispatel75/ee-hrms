import{r as c,j as o}from"./ui-5WRyBZNT.js";import{P as le}from"./page-template-CKIx2Cd4.js";import{u as ne,c as de,w as pe,P as ce,r as n,t as s}from"./app-Dcb6Z4yW.js";import{C as me}from"./CrudTable-bZrcaGsl.js";import{C as q}from"./CrudFormModal-CMKQqXhM.js";import{C as ue}from"./CrudDeleteModal-h-4oV4Ln.js";import{P as fe}from"./pagination-BW8eSOCk.js";import{S as ge}from"./search-and-filter-bar-BYwCPSIS.js";import"./textarea-LYs2mVcU.js";import"./select-DeRz6PSF.js";import"./index-BdQq_4o_.js";import"./index-CCaALC5E.js";import"./language-WoaYFWNr.js";import"./trophy-CwLH3bof.js";import"./loader-circle-BHYyy5xm.js";import"./copy-CEvMX_m9.js";import"./CookieConsentBanner-DQyHDBeh.js";import"./switch-t9Hay6Hq.js";import"./chevron-right-D-6n0McF.js";import"./credit-card-DqjaQidM.js";import"./dollar-sign-Cwr3Gu39.js";import"./users-CMrPg0xJ.js";import"./clock-bjnTPlpB.js";import"./calendar-DCWku5XV.js";import"./user-mASyYuwG.js";import"./use-favicon-DuYrl8Bg.js";import"./use-brand-theme-Bndhjp9t.js";/* empty css            *//* empty css                  */import"./utils-BkYo4WJR.js";import"./table-CVC2OwXt.js";import"./unlink-M-7GhMDo.js";import"./wrench-EpLqRNAD.js";import"./arrow-left-2RHqSM1t.js";import"./ticket-49lGndAA.js";import"./lock-open-C1AE0wa5.js";import"./award-Ds8Pn3VU.js";import"./ban-CoJEhB2G.js";import"./wallet-V5ITs3Yp.js";import"./bell-DGfoV3HU.js";import"./building-2-NAKjIPfs.js";import"./building-Yd460mDP.js";import"./trending-down-uJsbmf-r.js";import"./camera-8w012zob.js";import"./chart-column-B4Juta60.js";import"./chart-no-axes-column-increasing-CxynlTOn.js";import"./chevron-left-CAhfRZ8t.js";import"./circle-alert-DyiJ_7fc.js";import"./circle-check-big-DvjFjVFs.js";import"./circle-check-SPi-Xvck.js";import"./circle-CTH8Grzw.js";import"./clipboard-list-BeCtsJjD.js";import"./zap-C99Wcc2V.js";import"./download-D7x9V5HF.js";import"./ellipsis-CcCiYkNb.js";import"./external-link-jFGKNT7b.js";import"./eye-off-ZW0JdLst.js";import"./eye-BauIsDws.js";import"./filter-CUtbTrvr.js";import"./rotate-ccw-C8Q-gmhj.js";import"./hard-drive-B2P2rmjY.js";import"./info-DMPjqPji.js";import"./key-CGMSITmc.js";import"./lightbulb-CAdzOdqD.js";import"./link-2-DCTQflBu.js";import"./list-DOApis6K.js";import"./lock-DTdsSPVo.js";import"./mail-DLXHGnVS.js";import"./map-pin-zN3uCaOh.js";import"./phone-C8cPu9FG.js";import"./printer-ChUpiFfe.js";import"./refresh-cw-BLGufQC4.js";import"./send-COw_7dkc.js";import"./server-B9axTPGI.js";import"./square-pen-B2niO3pF.js";import"./star-C6nMG0b0.js";import"./trash-2-CeLXIVfe.js";import"./trash-BE31V_4e.js";import"./trending-up-ClbmsTa0.js";import"./triangle-alert-Bgud0J1k.js";import"./user-plus-Dd4He1MR.js";import"./radio-group-CWZh11qV.js";import"./checkbox-B5iZmSiS.js";import"./scroll-area-BNTU7Fcp.js";function Kt(){var P,A,$,k;const{t:e}=ne(),{auth:f,offers:i,candidates:x,departments:M,employees:R,jobPostings:_e,currentUser:h,filters:l={}}=de().props,v=(f==null?void 0:f.permissions)||[],[g,w]=c.useState(l.search||""),[d,D]=c.useState(l.status||"_empty_"),[p,C]=c.useState(l.candidate_id||"_empty_"),[B,O]=c.useState(!1),[U,S]=c.useState(!1),[V,_]=c.useState(!1),[L,y]=c.useState(!1),[a,j]=c.useState(null),[u,F]=c.useState("create"),z=()=>d!=="_empty_"||p!=="_empty_"||g!=="",G=()=>(d!=="_empty_"?1:0)+(p!=="_empty_"?1:0)+(g!==""?1:0),H=t=>{t.preventDefault(),N()},N=()=>{n.get(route("hr.recruitment.offers.index"),{page:1,search:g||void 0,status:d!=="_empty_"?d:void 0,candidate_id:p!=="_empty_"?p:void 0,per_page:l.per_page},{preserveState:!0,preserveScroll:!0})},J=t=>{const r=l.sort_field===t&&l.sort_direction==="asc"?"desc":"asc";n.get(route("hr.recruitment.offers.index"),{sort_field:t,sort_direction:r,page:1,search:g||void 0,status:d!=="_empty_"?d:void 0,candidate_id:p!=="_empty_"?p:void 0,per_page:l.per_page},{preserveState:!0,preserveScroll:!0})},K=(t,r)=>{switch(j(r),t){case"view":n.get(route("hr.recruitment.offers.show",r.id));break;case"edit":F("edit"),_(!0);break;case"delete":S(!0);break;case"update-status":y(!0);break}},Q=()=>{j(null),F("create"),_(!0)},W=t=>{u==="create"?(s.loading(e("Creating offer...")),n.post(route("hr.recruitment.offers.store"),t,{onSuccess:r=>{_(!1),s.dismiss(),r.props.flash.success?s.success(e(r.props.flash.success)):r.props.flash.error?s.error(e(r.props.flash.error)):s.success(e("Offer created successfully"))},onError:r=>{s.dismiss(),typeof r=="string"?s.error(r):s.error(`Failed to create offer: ${Object.values(r).join(", ")}`)}})):u==="edit"&&(s.loading(e("Updating offer...")),n.put(route("hr.recruitment.offers.update",a.id),t,{onSuccess:r=>{_(!1),s.dismiss(),r.props.flash.success?s.success(e(r.props.flash.success)):r.props.flash.error?s.error(e(r.props.flash.error)):s.success(e("Offer updated successfully"))},onError:r=>{s.dismiss(),typeof r=="string"?s.error(r):s.error(`Failed to update offer: ${Object.values(r).join(", ")}`)}}))},X=()=>{s.loading(e("Deleting offer...")),n.delete(route("hr.recruitment.offers.destroy",a.id),{onSuccess:t=>{S(!1),s.dismiss(),t.props.flash.success?s.success(e(t.props.flash.success)):t.props.flash.error?s.error(e(t.props.flash.error)):s.success(e("Offer deleted successfully"))},onError:t=>{s.dismiss(),typeof t=="string"?s.error(t):s.error(`Failed to delete offer: ${Object.values(t).join(", ")}`)}})},Y=t=>{s.loading(e("Updating status...")),n.put(route("hr.recruitment.offers.update-status",a.id),t,{onSuccess:r=>{y(!1),s.dismiss(),r.props.flash.success?s.success(e(r.props.flash.success)):r.props.flash.error?s.error(e(r.props.flash.error)):s.success(e("Status updated successfully"))},onError:r=>{s.dismiss(),typeof r=="string"?s.error(r):s.error(`Failed to update status: ${Object.values(r).join(", ")}`)}})},Z=()=>{w(""),D("_empty_"),C("_empty_"),O(!1),n.get(route("hr.recruitment.offers.index"),{page:1,per_page:l.per_page},{preserveState:!0,preserveScroll:!0})},E=[];pe(v,"create-offers")&&E.push({label:e("Create Offer"),icon:o.jsx(ce,{className:"h-4 w-4 mr-2"}),variant:"default",onClick:()=>Q()});const I=[{title:e("Dashboard"),href:route("dashboard")},{title:e("Recruitment"),href:route("hr.recruitment.offers.index")},{title:e("Offers")}],ee=t=>{switch(t){case"Draft":return"bg-gray-50 text-gray-600 ring-gray-500/10";case"Sent":return"bg-blue-50 text-blue-700 ring-blue-600/20";case"Accepted":return"bg-green-50 text-green-700 ring-green-600/20";case"Negotiating":return"bg-yellow-50 text-yellow-800 ring-yellow-600/20";case"Declined":return"bg-red-50 text-red-700 ring-red-600/10";case"Expired":return"bg-orange-50 text-orange-700 ring-orange-600/20";default:return"bg-gray-50 text-gray-600 ring-gray-500/10"}},te=[{key:"candidate.full_name",label:e("Candidate"),render:(t,r)=>{var m,b,T;return o.jsxs("div",{children:[o.jsxs("div",{className:"font-medium",children:[(m=r.candidate)==null?void 0:m.first_name," ",(b=r.candidate)==null?void 0:b.last_name]}),o.jsx("div",{className:"text-xs text-gray-500",children:(T=r.job)==null?void 0:T.title})]})}},{key:"salary",label:e("Salary"),render:(t,r)=>{var m;return o.jsx("div",{children:o.jsx("div",{className:"font-medium",children:(m=window.appSettings)==null?void 0:m.formatCurrency(t)})})}},{key:"start_date",label:e("Start Date"),sortable:!1,render:t=>{var r;return((r=window.appSettings)==null?void 0:r.formatDateTimeSimple(t,!1))||new Date(t).toLocaleDateString()}},{key:"expiration_date",label:e("Expires"),sortable:!1,render:t=>{var b;if(!t)return"-";const r=new Date(t),m=r<new Date;return o.jsxs("div",{className:m?"text-red-600":"",children:[(b=window.appSettings)==null?void 0:b.formatDateTimeSimple(r,!1),m&&o.jsx("div",{className:"text-xs",children:"Expired"})]})}},{key:"status",label:e("Status"),render:t=>o.jsx("span",{className:`inline-flex items-center rounded-md px-2 py-1 text-xs font-medium ring-1 ring-inset ${ee(t)}`,children:e(t)})},{key:"offer_date",label:e("Offer Date"),sortable:!1,render:t=>{var r;return((r=window.appSettings)==null?void 0:r.formatDateTimeSimple(t,!1))||new Date(t).toLocaleDateString()}}],re=[{label:e("View"),icon:"Eye",action:"view",className:"text-blue-500",requiredPermission:"view-offers"},{label:e("Edit"),icon:"Edit",action:"edit",className:"text-amber-500",requiredPermission:"edit-offers",condition:t=>!["Accepted","Declined"].includes(t.status)},{label:e("Update Status"),icon:"RefreshCw",action:"update-status",className:"text-green-500",requiredPermission:"edit-offers",condition:t=>!["Accepted","Declined"].includes(t.status)},{label:e("Delete"),icon:"Trash2",action:"delete",className:"text-red-500",requiredPermission:"delete-offers"}],ae=[{value:"_empty_",label:e("All Statuses"),disabled:!0},{value:"Draft",label:e("Draft")},{value:"Sent",label:e("Sent")},{value:"Accepted",label:e("Accepted")},{value:"Negotiating",label:e("Negotiating")},{value:"Declined",label:e("Declined")},{value:"Expired",label:e("Expired")}],se=[{value:"_empty_",label:e("All Candidates"),disabled:!0},...(x||[]).map(t=>({value:t.id.toString(),label:`${t.first_name} ${t.last_name}`}))],ie=[{value:"_empty_",label:e("Select Candidate")},...(x||[]).map(t=>({value:t.id.toString(),label:`${t.first_name} ${t.last_name}`}))];[...(M||[]).map(t=>{var r;return{value:t.id.toString(),label:`${t.name} - ${((r=t.branch)==null?void 0:r.name)||"No Branch"}`}})];const oe=[{value:"_empty_",label:e("Select Approver")},...(R||[]).map(t=>{var r;return{value:t.id.toString(),label:`${t.name} - ${((r=f==null?void 0:f.user)==null?void 0:r.name)||"Company"}`}})];return o.jsxs(le,{title:e("Offers"),url:"/hr/recruitment/offers",actions:E,breadcrumbs:I,noPadding:!0,children:[o.jsx("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow mb-4 p-4",children:o.jsx(ge,{searchTerm:g,onSearchChange:w,onSearch:H,filters:[{name:"status",label:e("Status"),type:"select",value:d,onChange:D,options:ae,searchable:!0},{name:"candidate_id",label:e("Candidate"),type:"select",value:p,onChange:C,options:se,searchable:!0}],showFilters:B,setShowFilters:O,hasActiveFilters:z,activeFilterCount:G,onResetFilters:Z,onApplyFilters:N,currentPerPage:((P=l.per_page)==null?void 0:P.toString())||"10",onPerPageChange:t=>{n.get(route("hr.recruitment.offers.index"),{page:1,per_page:parseInt(t),search:g||void 0,status:d!=="_empty_"?d:void 0,candidate_id:p!=="_empty_"?p:void 0},{preserveState:!0,preserveScroll:!0})}})}),o.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow overflow-hidden",children:[o.jsx(me,{columns:te,actions:re,data:(i==null?void 0:i.data)||[],from:(i==null?void 0:i.from)||1,onAction:K,sortField:l.sort_field,sortDirection:l.sort_direction,onSort:J,permissions:v,entityPermissions:{view:"view-offers",create:"create-offers",edit:"edit-offers",delete:"delete-offers"}}),o.jsx(fe,{from:(i==null?void 0:i.from)||0,to:(i==null?void 0:i.to)||0,total:(i==null?void 0:i.total)||0,links:i==null?void 0:i.links,entityName:e("offers"),onPageChange:t=>n.get(t)})]}),o.jsx(q,{isOpen:V,onClose:()=>_(!1),onSubmit:W,formConfig:{fields:[{name:"candidate_id",type:"dependent-dropdown",dependentConfig:[{name:"candidate_id",label:e("Candidate"),required:!0,searchable:!0,options:ie.filter(t=>t.value!=="_empty_")},{name:"position",label:e("Position"),required:!0,apiEndpoint:"/hr/recruitment/offers/candidate/{candidate_id}/job",showCurrentValue:!0,searchable:!0},{name:"department_id",label:e("Department"),required:!1,apiEndpoint:"/hr/recruitment/offers/job/{position}/departments",searchable:!1,disabled:!0,selectFirstOption:!0}]},{name:"salary",label:e("Salary"),type:"number",required:!0,min:0,step:.01},{name:"start_date",label:e("Start Date"),type:"date",required:!0},{name:"expiration_date",label:e("Expiration Date"),type:"date",required:!0},{name:"approved_by",label:e("Approved By"),type:"select",required:!0,options:oe.filter(t=>t.value!=="_empty_"),defaultValue:(A=h==null?void 0:h.id)==null?void 0:A.toString()},{name:"benefits",label:e("Benefits"),type:"textarea"}],modalSize:"xl"},initialData:u==="create"?{}:u==="view"?{...a,candidate_id:a!=null&&a.candidate?`${a.candidate.first_name} ${a.candidate.last_name}`:a==null?void 0:a.candidate_id,start_date:a!=null&&a.start_date?new Date(a.start_date).toISOString().split("T")[0]:a==null?void 0:a.start_date,expiration_date:a!=null&&a.expiration_date?new Date(a.expiration_date).toISOString().split("T")[0]:a==null?void 0:a.expiration_date}:{...a,start_date:a!=null&&a.start_date?new Date(a.start_date).toISOString().split("T")[0]:a==null?void 0:a.start_date,expiration_date:a!=null&&a.expiration_date?new Date(a.expiration_date).toISOString().split("T")[0]:a==null?void 0:a.expiration_date},title:e(u==="create"?"Create New Offer":u==="edit"?"Edit Offer":"View Offer"),mode:u}),o.jsx(ue,{isOpen:U,onClose:()=>S(!1),onConfirm:X,itemName:a?`${($=a.candidate)==null?void 0:$.first_name} ${(k=a.candidate)==null?void 0:k.last_name} - ${a.position}`:"",entityName:"offer"}),o.jsx(q,{isOpen:L,onClose:()=>y(!1),onSubmit:Y,formConfig:{fields:[{name:"status",label:e("Status"),type:"select",required:!0,options:[{value:"Draft",label:e("Draft")},{value:"Sent",label:e("Sent")},{value:"Accepted",label:e("Accepted")},{value:"Negotiating",label:e("Negotiating")},{value:"Declined",label:e("Declined")},{value:"Expired",label:e("Expired")}]}]},initialData:a?{status:a.status}:{},title:e("Update Offer Status"),mode:"edit"})]})}export{Kt as default};
