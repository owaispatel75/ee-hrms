import{r as p,j as s}from"./ui-5WRyBZNT.js";import{P as oe}from"./page-template-CKIx2Cd4.js";import{u as le,c as ne,w as pe,P as me,r as c,D as q,h as $,i as R,j as V,L as ce,I as de,n as L,t as a}from"./app-Dcb6Z4yW.js";import{C as ue}from"./CrudTable-bZrcaGsl.js";import{C as fe}from"./CrudFormModal-CMKQqXhM.js";import{C as he}from"./CrudDeleteModal-h-4oV4Ln.js";import{P as ge}from"./pagination-BW8eSOCk.js";import{S as xe}from"./search-and-filter-bar-BYwCPSIS.js";import"./textarea-LYs2mVcU.js";import"./select-DeRz6PSF.js";import"./index-BdQq_4o_.js";import"./index-CCaALC5E.js";import"./language-WoaYFWNr.js";import"./trophy-CwLH3bof.js";import"./loader-circle-BHYyy5xm.js";import"./copy-CEvMX_m9.js";import"./CookieConsentBanner-DQyHDBeh.js";import"./switch-t9Hay6Hq.js";import"./chevron-right-D-6n0McF.js";import"./credit-card-DqjaQidM.js";import"./dollar-sign-Cwr3Gu39.js";import"./users-CMrPg0xJ.js";import"./clock-bjnTPlpB.js";import"./calendar-DCWku5XV.js";import"./user-mASyYuwG.js";import"./use-favicon-DuYrl8Bg.js";import"./use-brand-theme-Bndhjp9t.js";/* empty css            *//* empty css                  */import"./utils-BkYo4WJR.js";import"./table-CVC2OwXt.js";import"./unlink-M-7GhMDo.js";import"./wrench-EpLqRNAD.js";import"./arrow-left-2RHqSM1t.js";import"./ticket-49lGndAA.js";import"./lock-open-C1AE0wa5.js";import"./award-Ds8Pn3VU.js";import"./ban-CoJEhB2G.js";import"./wallet-V5ITs3Yp.js";import"./bell-DGfoV3HU.js";import"./building-2-NAKjIPfs.js";import"./building-Yd460mDP.js";import"./trending-down-uJsbmf-r.js";import"./camera-8w012zob.js";import"./chart-column-B4Juta60.js";import"./chart-no-axes-column-increasing-CxynlTOn.js";import"./chevron-left-CAhfRZ8t.js";import"./circle-alert-DyiJ_7fc.js";import"./circle-check-big-DvjFjVFs.js";import"./circle-check-SPi-Xvck.js";import"./circle-CTH8Grzw.js";import"./clipboard-list-BeCtsJjD.js";import"./zap-C99Wcc2V.js";import"./download-D7x9V5HF.js";import"./ellipsis-CcCiYkNb.js";import"./external-link-jFGKNT7b.js";import"./eye-off-ZW0JdLst.js";import"./eye-BauIsDws.js";import"./filter-CUtbTrvr.js";import"./rotate-ccw-C8Q-gmhj.js";import"./hard-drive-B2P2rmjY.js";import"./info-DMPjqPji.js";import"./key-CGMSITmc.js";import"./lightbulb-CAdzOdqD.js";import"./link-2-DCTQflBu.js";import"./list-DOApis6K.js";import"./lock-DTdsSPVo.js";import"./mail-DLXHGnVS.js";import"./map-pin-zN3uCaOh.js";import"./phone-C8cPu9FG.js";import"./printer-ChUpiFfe.js";import"./refresh-cw-BLGufQC4.js";import"./send-COw_7dkc.js";import"./server-B9axTPGI.js";import"./square-pen-B2niO3pF.js";import"./star-C6nMG0b0.js";import"./trash-2-CeLXIVfe.js";import"./trash-BE31V_4e.js";import"./trending-up-ClbmsTa0.js";import"./triangle-alert-Bgud0J1k.js";import"./user-plus-Dd4He1MR.js";import"./radio-group-CWZh11qV.js";import"./checkbox-B5iZmSiS.js";import"./scroll-area-BNTU7Fcp.js";function Xt(){var T,E;const{t}=le(),{auth:v,offerTemplates:o,filters:n={}}=ne().props,w=(v==null?void 0:v.permissions)||[],[d,N]=p.useState(n.search||""),[m,_]=p.useState(n.status||"_empty_"),[G,C]=p.useState(!1),[U,y]=p.useState(!1),[B,u]=p.useState(!1),[z,O]=p.useState(!1),[H,x]=p.useState(!1),[i,b]=p.useState(null),[f,j]=p.useState("create"),[P,S]=p.useState({}),J=()=>m!=="_empty_"||d!=="",K=()=>(m!=="_empty_"?1:0)+(d!==""?1:0),X=e=>{e.preventDefault(),F()},F=()=>{c.get(route("hr.recruitment.offer-templates.index"),{page:1,search:d||void 0,status:m!=="_empty_"?m:void 0,per_page:n.per_page},{preserveState:!0,preserveScroll:!0})},I=e=>{const r=n.sort_field===e&&n.sort_direction==="asc"?"desc":"asc";c.get(route("hr.recruitment.offer-templates.index"),{sort_field:e,sort_direction:r,page:1,search:d||void 0,status:m!=="_empty_"?m:void 0,per_page:n.per_page},{preserveState:!0,preserveScroll:!0})},Q=(e,r)=>{switch(b(r),e){case"view":j("view"),u(!0);break;case"edit":j("edit"),u(!0);break;case"delete":y(!0);break;case"toggle-status":Y(r);break;case"preview":b(r),O(!0);break;case"generate":if(r.variables&&r.variables.length>0){const l={};r.variables.forEach(h=>{l[h]=""}),S(l),b(r),x(!0)}else k(r,{});break}},W=()=>{b(null),j("create"),u(!0)},Y=e=>{const r=e.status==="active"?"inactive":"active";a.loading(`${t(r==="active"?"Activating":"Deactivating")} template...`),c.put(route("hr.recruitment.offer-templates.toggle-status",e.id),{},{onSuccess:l=>{a.dismiss(),l.props.flash.success?a.success(t(l.props.flash.success)):l.props.flash.error&&a.error(t(l.props.flash.error))},onError:l=>{a.dismiss(),typeof l=="string"?a.error(l):a.error(`Failed to update template status: ${Object.values(l).join(", ")}`)}})},Z=e=>{e.variables&&typeof e.variables=="string"&&(e.variables=e.variables.split(",").map(r=>r.trim()).filter(Boolean)),f==="create"?(a.loading(t("Creating template...")),c.post(route("hr.recruitment.offer-templates.store"),e,{onSuccess:r=>{u(!1),a.dismiss(),r.props.flash.success?a.success(t(r.props.flash.success)):r.props.flash.error&&a.error(t(r.props.flash.error))},onError:r=>{a.dismiss(),typeof r=="string"?a.error(r):a.error(`Failed to create template: ${Object.values(r).join(", ")}`)}})):f==="edit"&&(a.loading(t("Updating template...")),c.put(route("hr.recruitment.offer-templates.update",i.id),e,{onSuccess:r=>{u(!1),a.dismiss(),r.props.flash.success?a.success(t(r.props.flash.success)):r.props.flash.error&&a.error(t(r.props.flash.error))},onError:r=>{a.dismiss(),typeof r=="string"?a.error(r):a.error(`Failed to update template: ${Object.values(r).join(", ")}`)}}))},ee=()=>{a.loading(t("Deleting template...")),c.delete(route("hr.recruitment.offer-templates.destroy",i.id),{onSuccess:e=>{y(!1),a.dismiss(),e.props.flash.success?a.success(t(e.props.flash.success)):e.props.flash.error&&a.error(t(e.props.flash.error))},onError:e=>{a.dismiss(),typeof e=="string"?a.error(e):a.error(`Failed to delete template: ${Object.values(e).join(", ")}`)}})},k=(e,r)=>{var l;fetch(route("hr.recruitment.offer-templates.generate",e.id),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((l=document.querySelector('meta[name="csrf-token"]'))==null?void 0:l.getAttribute("content"))||""},body:JSON.stringify({variables:r})}).then(h=>h.blob()).then(h=>{const M=window.URL.createObjectURL(h),g=document.createElement("a");g.href=M,g.download=`${e.name}_${new Date().toISOString().split("T")[0]}.pdf`,document.body.appendChild(g),g.click(),window.URL.revokeObjectURL(M),document.body.removeChild(g)})},te=()=>{k(i,P),x(!1),S({})},re=()=>{N(""),_("_empty_"),C(!1),c.get(route("hr.recruitment.offer-templates.index"),{page:1,per_page:n.per_page},{preserveState:!0,preserveScroll:!0})},A=[];pe(w,"create-offer-templates")&&A.push({label:t("Add Template"),icon:s.jsx(me,{className:"h-4 w-4 mr-2"}),variant:"default",onClick:()=>W()});const se=[{title:t("Dashboard"),href:route("dashboard")},{title:t("Recruitment"),href:route("hr.recruitment.offer-templates.index")},{title:t("Offer Templates")}],ae=[{key:"name",label:t("Name"),sortable:!0,render:e=>s.jsx("div",{className:"font-medium",children:e})},{key:"template_content",label:t("Content Preview"),render:e=>s.jsx("div",{className:"max-w-xs",children:s.jsx("div",{className:"text-sm text-gray-600 truncate",children:e?e.substring(0,100)+(e.length>100?"...":""):"-"})})},{key:"variables",label:t("Variables"),render:e=>!e||!Array.isArray(e)||e.length===0?"-":s.jsxs("div",{className:"flex flex-wrap gap-1",children:[e.slice(0,3).map((r,l)=>s.jsx("span",{className:"inline-flex items-center rounded-md bg-blue-50 px-2 py-1 text-xs font-medium text-blue-700 ring-1 ring-inset ring-blue-600/20",children:r},l)),e.length>3&&s.jsxs("span",{className:"text-xs text-gray-500",children:["+",e.length-3," more"]})]})},{key:"status",label:t("Status"),render:e=>s.jsx("span",{className:`inline-flex items-center rounded-md px-2 py-1 text-xs font-medium ${e==="active"?"bg-green-50 text-green-700 ring-1 ring-inset ring-green-600/20":"bg-red-50 text-red-700 ring-1 ring-inset ring-red-600/20"}`,children:t(e==="active"?"Active":"Inactive")})},{key:"created_at",label:t("Created At"),sortable:!0,render:e=>{var r;return((r=window.appSettings)==null?void 0:r.formatDateTimeSimple(e,!1))||new Date(e).toLocaleDateString()}}],ie=[{label:t("View"),icon:"Eye",action:"view",className:"text-blue-500",requiredPermission:"view-offer-templates"},{label:t("Preview"),icon:"FileText",action:"preview",className:"text-purple-500",requiredPermission:"view-offer-templates"},{label:t("Generate Offer"),icon:"Download",action:"generate",className:"text-green-500",requiredPermission:"view-offer-templates"},{label:t("Edit"),icon:"Edit",action:"edit",className:"text-amber-500",requiredPermission:"edit-offer-templates"},{label:t("Toggle Status"),icon:"Lock",action:"toggle-status",className:"text-amber-500",requiredPermission:"edit-offer-templates"},{label:t("Delete"),icon:"Trash2",action:"delete",className:"text-red-500",requiredPermission:"delete-offer-templates"}],D=[{value:"_empty_",label:t("All Statuses")},{value:"active",label:t("Active")},{value:"inactive",label:t("Inactive")}];return s.jsxs(oe,{title:t("Offer Templates"),url:"/hr/recruitment/offer-templates",actions:A,breadcrumbs:se,noPadding:!0,children:[s.jsx("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow mb-4 p-4",children:s.jsx(xe,{searchTerm:d,onSearchChange:N,onSearch:X,filters:[{name:"status",label:t("Status"),type:"select",value:m,onChange:_,options:D}],showFilters:G,setShowFilters:C,hasActiveFilters:J,activeFilterCount:K,onResetFilters:re,onApplyFilters:F,currentPerPage:((T=n.per_page)==null?void 0:T.toString())||"10",onPerPageChange:e=>{c.get(route("hr.recruitment.offer-templates.index"),{page:1,per_page:parseInt(e),search:d||void 0,status:m!=="_empty_"?m:void 0},{preserveState:!0,preserveScroll:!0})}})}),s.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow overflow-hidden",children:[s.jsx(ue,{columns:ae,actions:ie,data:(o==null?void 0:o.data)||[],from:(o==null?void 0:o.from)||1,onAction:Q,sortField:n.sort_field,sortDirection:n.sort_direction,onSort:I,permissions:w,entityPermissions:{view:"view-offer-templates",create:"create-offer-templates",edit:"edit-offer-templates",delete:"delete-offer-templates"}}),s.jsx(ge,{from:(o==null?void 0:o.from)||0,to:(o==null?void 0:o.to)||0,total:(o==null?void 0:o.total)||0,links:o==null?void 0:o.links,entityName:t("offer templates"),onPageChange:e=>c.get(e)})]}),s.jsx(fe,{isOpen:B,onClose:()=>u(!1),onSubmit:Z,formConfig:{fields:[{name:"name",label:t("Template Name"),type:"text",required:!0},{name:"template_content",label:t("Template Content"),type:"textarea",required:!0,rows:10,helpText:t("Use {{variable_name}} for dynamic content")},{name:"variables",label:t("Variables"),type:"text",helpText:t("Comma-separated list of variables (e.g., candidate_name, position, salary)")},{name:"status",label:t("Status"),type:"select",required:!0,options:D.filter(e=>e.value!=="_empty_")}],modalSize:"xl"},initialData:i?{...i,variables:i.variables?i.variables.join(", "):""}:null,title:t(f==="create"?"Add New Offer Template":f==="edit"?"Edit Offer Template":"View Offer Template"),mode:f}),s.jsx(he,{isOpen:U,onClose:()=>y(!1),onConfirm:ee,itemName:(i==null?void 0:i.name)||"",entityName:"offer template"}),s.jsx(q,{open:z,onOpenChange:O,children:s.jsxs($,{className:"max-w-4xl max-h-[80vh]",children:[s.jsx(R,{children:s.jsxs(V,{children:[t("Template Preview"),": ",i==null?void 0:i.name]})}),s.jsxs("div",{className:"mt-4 overflow-y-auto max-h-[60vh] pr-1",children:[s.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 p-4 rounded-lg border",children:s.jsx("pre",{className:"whitespace-pre-wrap text-sm font-mono",children:(i==null?void 0:i.template_content)||t("No content available")})}),(i==null?void 0:i.variables)&&i.variables.length>0&&s.jsxs("div",{className:"mt-4",children:[s.jsxs("h4",{className:"text-sm font-medium mb-2",children:[t("Available Variables"),":"]}),s.jsx("div",{className:"flex flex-wrap gap-2",children:i.variables.map((e,r)=>s.jsx("span",{className:"inline-flex items-center rounded-md bg-blue-50 px-2 py-1 text-xs font-medium text-blue-700 ring-1 ring-inset ring-blue-600/20",children:`{{${e}}}`},r))})]})]})]})}),s.jsx(q,{open:H,onOpenChange:x,children:s.jsxs($,{className:"max-w-lg max-h-[80vh]",children:[s.jsxs(R,{children:[s.jsx(V,{className:"text-lg font-semibold",children:t("Generate Offer")}),s.jsx("p",{className:"text-sm text-gray-600",children:i==null?void 0:i.name})]}),s.jsx("div",{className:"overflow-y-auto max-h-[50vh] space-y-3 py-2 pr-2",children:(E=i==null?void 0:i.variables)==null?void 0:E.map(e=>s.jsxs("div",{className:"space-y-1",children:[s.jsx(ce,{htmlFor:e,className:"text-sm font-medium",children:e.replace(/_/g," ").replace(/\b\w/g,r=>r.toUpperCase())}),s.jsx(de,{id:e,value:P[e]||"",onChange:r=>S(l=>({...l,[e]:r.target.value})),placeholder:`Enter ${e.replace(/_/g," ")}`})]},e))}),s.jsxs("div",{className:"flex justify-end space-x-2 pt-2 border-t",children:[s.jsx(L,{variant:"outline",onClick:()=>x(!1),children:t("Cancel")}),s.jsx(L,{onClick:te,className:"bg-red-500 hover:bg-red-600",children:t("Generate PDF")})]})]})})]})}export{Xt as default};
