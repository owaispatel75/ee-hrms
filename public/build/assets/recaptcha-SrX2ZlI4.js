import{r as o,j as f}from"./ui-5WRyBZNT.js";import{c as R}from"./app-Dcb6Z4yW.js";function b({onVerify:s,onExpired:d,onError:c}){const{settings:r={}}=R().props,l=o.useRef(null),t=o.useRef(null),i=o.useRef(`recaptcha-${Math.random().toString(36).substr(2,9)}`),n=r.recaptchaEnabled==="true"||r.recaptchaEnabled===!0||r.recaptchaEnabled===1||r.recaptchaEnabled==="1",p=r.recaptchaVersion||"v2",a=r.recaptchaSiteKey||"";return o.useEffect(()=>{if(!n||!a)return;const h=()=>{try{p==="v2"?u():w()}catch(e){console.error("ReCaptcha load error:",e),c&&c()}},u=()=>{if(window.grecaptcha&&l.current&&t.current===null)try{t.current=window.grecaptcha.render(i.current,{sitekey:a,callback:s,"expired-callback":d||(()=>{}),"error-callback":c||(()=>{})})}catch(e){console.error("ReCaptcha v2 render error:",e)}},w=()=>{if(window.grecaptcha)try{window.grecaptcha.ready(()=>{window.grecaptcha.execute(a,{action:"submit"}).then(e=>{s(e)}).catch(e=>{console.error("ReCaptcha v3 execute error:",e),c&&c()})})}catch(e){console.error("ReCaptcha v3 ready error:",e)}};if(window.grecaptcha)h();else{window.onRecaptchaLoad=h;const e=document.createElement("script");e.src=`https://www.google.com/recaptcha/api.js?onload=onRecaptchaLoad&render=${p==="v3"?a:"explicit"}`,e.async=!0,e.defer=!0,e.onerror=()=>{console.error("Failed to load ReCaptcha script"),c&&c()},document.head.appendChild(e)}return()=>{try{t.current!==null&&window.grecaptcha&&(window.grecaptcha.reset(t.current),t.current=null)}catch(e){console.error("ReCaptcha cleanup error:",e)}}},[n,a]),!n||!a?null:p==="v2"?f.jsx("div",{id:i.current,ref:l}):null}export{b as R};
