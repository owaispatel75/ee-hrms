import{r as _,j as e}from"./ui-5WRyBZNT.js";import{c as v,u as C,al as T,C as Z,k as A,L as m,I as x,n as g,x as P,t as o,r as j}from"./app-Dcb6Z4yW.js";import{T as I}from"./textarea-LYs2mVcU.js";import{A as M,a as E}from"./alert-_QIJbTlc.js";import{C as F}from"./circle-alert-DyiJ_7fc.js";import{K as G}from"./key-CGMSITmc.js";/* empty css            *//* empty css                  */import"./utils-BkYo4WJR.js";const S=c=>{const{auth:s}=v().props;return!s||!s.user||!s.permissions?!1:s.permissions.includes(c)};function J({settings:c={}}){const{t:s}=C(),{globalSettings:t}=v().props,y=S("manage-biomatric-attedance-settings"),[a,p]=_.useState({zkteco_api_url:"",zkteco_username:"",zkteco_password:"",zkteco_auth_token:""}),[f,k]=_.useState(!1);_.useEffect(()=>{p({zkteco_api_url:c.zkteco_api_url||"",zkteco_username:c.zkteco_username||"",zkteco_password:c.zkteco_password||"",zkteco_auth_token:c.zkteco_auth_token||""})},[c]);const h=(r,n)=>{p(i=>({...i,[r]:n}))},N=r=>{r.preventDefault(),t!=null&&t.is_demo||o.loading(s("Saving Zekto settings...")),j.post(route("settings.zekto.update"),a,{preserveScroll:!0,onSuccess:n=>{var d,u;t!=null&&t.is_demo||o.dismiss();const i=(d=n.props.flash)==null?void 0:d.success,l=(u=n.props.flash)==null?void 0:u.error;i?o.success(i):l?o.error(l):o.success(s("Zekto settings saved successfully"))},onError:n=>{t!=null&&t.is_demo||o.dismiss();const i=n.error||Object.values(n).join(", ")||s("Failed to save Zekto settings");o.error(i)}})},w=()=>{if(!a.zkteco_api_url||!a.zkteco_username||!a.zkteco_password){o.error(s("Please fill in API URL, Username, and Password before generating token"));return}k(!0),t!=null&&t.is_demo||o.loading(s("Generating auth token...")),j.post(route("settings.zekto.generate-token"),{zkteco_api_url:a.zkteco_api_url,zkteco_username:a.zkteco_username,zkteco_password:a.zkteco_password},{preserveScroll:!0,onSuccess:r=>{var d,u,z;k(!1),t!=null&&t.is_demo||o.dismiss();const n=(d=r.props.flash)==null?void 0:d.success,i=(u=r.props.flash)==null?void 0:u.error,l=(z=r.props.flash)==null?void 0:z.token;n&&l?(p(b=>({...b,zkteco_auth_token:l})),o.success(n)):i&&o.error(i)},onError:r=>{k(!1),t!=null&&t.is_demo||o.dismiss();const n=r.error||Object.values(r).join(", ")||s("Failed to generate auth token");o.error(n)}})};return e.jsx(T,{title:s("Zekto Settings"),description:s("Configure ZKTeco biometric attendance system integration"),action:e.jsxs(g,{type:"submit",form:"zekto-settings-form",size:"sm",children:[e.jsx(P,{className:"h-4 w-4 mr-2"}),s("Save Changes")]}),children:e.jsx(Z,{children:e.jsxs(A,{className:"pt-6",children:[e.jsxs(M,{className:"mb-6 border-blue-200 bg-blue-50 text-blue-800",children:[e.jsx(F,{className:"h-4 w-4 text-blue-600 self-center"}),e.jsxs(E,{className:"font-medium space-y-2 flex-1",children:[e.jsx("div",{children:s("Note that you can use the biometric attendance system only if you are using the ZKTeco machine for biometric attendance.")}),e.jsx("div",{children:s("If an employee has multiple entries in a single day, the first entry will be considered as clock-in time and the last entry will be considered as clock-out time.")})]})]}),e.jsx("form",{id:"zekto-settings-form",onSubmit:N,className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsxs(m,{htmlFor:"zkteco_api_url",children:[s("ZKTeco Api URL")," ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(x,{id:"zkteco_api_url",type:"text",placeholder:"http://110.78.645.123:8080",value:a.zkteco_api_url,onChange:r=>h("zkteco_api_url",r.target.value),required:!0}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[s("Example"),": http://110.78.645.123:8080"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsxs(m,{htmlFor:"zkteco_username",children:[s("Username")," ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(x,{id:"zkteco_username",type:"text",placeholder:"Zekto User Name",value:a.zkteco_username,onChange:r=>h("zkteco_username",r.target.value),required:!0})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsxs(m,{htmlFor:"zkteco_password",children:[s("Password")," ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(x,{id:"zkteco_password",type:"password",placeholder:"Zekto Password",value:a.zkteco_password,onChange:r=>h("zkteco_password",r.target.value),required:!0})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(m,{htmlFor:"zkteco_auth_token",children:s("Auth Token")}),e.jsx(I,{id:"zkteco_auth_token",placeholder:"Token will be generated automatically using API credentials",value:a.zkteco_auth_token,readOnly:!0,disabled:!0,rows:4,className:"resize-none bg-muted"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s("This token is automatically generated using your API credentials above.")})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(g,{type:"button",onClick:w,disabled:f||!a.zkteco_api_url||!a.zkteco_username||!a.zkteco_password||!y,className:"bg-green-600 hover:bg-green-700",children:[e.jsx(G,{className:"h-4 w-4 mr-2"}),s(f?"Generating...":"Generate Token")]})})]})})]})})})}export{J as default};
