import{r as h,j as u}from"./ui-5WRyBZNT.js";import{P as T}from"./page-template-CKIx2Cd4.js";import{C as D}from"./CrudTable-bZrcaGsl.js";import{c as $}from"./columnRenderers-Cgi8pn9D.js";import{t as a}from"./i18n-C_pO9QB7.js";import{u as M,c as V,r as m,t as p}from"./app-Dcb6Z4yW.js";import{P as B}from"./pagination-BW8eSOCk.js";import{S as I}from"./search-and-filter-bar-BYwCPSIS.js";import"./textarea-LYs2mVcU.js";import"./select-DeRz6PSF.js";import"./index-BdQq_4o_.js";import"./index-CCaALC5E.js";import"./language-WoaYFWNr.js";import"./trophy-CwLH3bof.js";import"./loader-circle-BHYyy5xm.js";import"./copy-CEvMX_m9.js";import"./CookieConsentBanner-DQyHDBeh.js";import"./switch-t9Hay6Hq.js";import"./chevron-right-D-6n0McF.js";import"./credit-card-DqjaQidM.js";import"./dollar-sign-Cwr3Gu39.js";import"./users-CMrPg0xJ.js";import"./clock-bjnTPlpB.js";import"./calendar-DCWku5XV.js";import"./user-mASyYuwG.js";import"./use-favicon-DuYrl8Bg.js";import"./use-brand-theme-Bndhjp9t.js";import"./table-CVC2OwXt.js";import"./unlink-M-7GhMDo.js";import"./wrench-EpLqRNAD.js";import"./arrow-left-2RHqSM1t.js";import"./ticket-49lGndAA.js";import"./lock-open-C1AE0wa5.js";import"./award-Ds8Pn3VU.js";import"./ban-CoJEhB2G.js";import"./wallet-V5ITs3Yp.js";import"./bell-DGfoV3HU.js";import"./building-2-NAKjIPfs.js";import"./building-Yd460mDP.js";import"./trending-down-uJsbmf-r.js";import"./camera-8w012zob.js";import"./chart-column-B4Juta60.js";import"./chart-no-axes-column-increasing-CxynlTOn.js";import"./chevron-left-CAhfRZ8t.js";import"./circle-alert-DyiJ_7fc.js";import"./circle-check-big-DvjFjVFs.js";import"./circle-check-SPi-Xvck.js";import"./circle-CTH8Grzw.js";import"./clipboard-list-BeCtsJjD.js";import"./zap-C99Wcc2V.js";import"./download-D7x9V5HF.js";import"./ellipsis-CcCiYkNb.js";import"./external-link-jFGKNT7b.js";import"./eye-off-ZW0JdLst.js";import"./eye-BauIsDws.js";import"./filter-CUtbTrvr.js";import"./rotate-ccw-C8Q-gmhj.js";import"./hard-drive-B2P2rmjY.js";import"./info-DMPjqPji.js";import"./key-CGMSITmc.js";import"./lightbulb-CAdzOdqD.js";import"./link-2-DCTQflBu.js";import"./list-DOApis6K.js";import"./lock-DTdsSPVo.js";import"./mail-DLXHGnVS.js";import"./map-pin-zN3uCaOh.js";import"./phone-C8cPu9FG.js";import"./printer-ChUpiFfe.js";import"./refresh-cw-BLGufQC4.js";import"./send-COw_7dkc.js";import"./server-B9axTPGI.js";import"./square-pen-B2niO3pF.js";import"./star-C6nMG0b0.js";import"./trash-2-CeLXIVfe.js";import"./trash-BE31V_4e.js";import"./trending-up-ClbmsTa0.js";import"./triangle-alert-Bgud0J1k.js";import"./user-plus-Dd4He1MR.js";/* empty css            *//* empty css                  */import"./utils-BkYo4WJR.js";const f={entity:{endpoint:route("plan-requests.index"),permissions:{view:"view-plan-requests",create:"create-plan-requests",edit:"edit-plan-requests",delete:"delete-plan-requests"}},description:a("Manage plan upgrade requests from users"),table:{columns:[{key:"user.name",label:a("Name"),sortable:!0},{key:"user.email",label:a("Email"),sortable:!0},{key:"plan.name",label:a("Plan Name"),sortable:!0},{key:"plan.duration",label:a("Plan Duration"),render:t=>t==="monthly"?a("Monthly"):a("Yearly")},{key:"status",label:a("Status"),render:$.status({pending:"bg-yellow-50 text-yellow-700 ring-1 ring-inset ring-yellow-600/20",approved:"bg-green-50 text-green-700 ring-1 ring-inset ring-green-600/20",rejected:"bg-red-50 text-red-700 ring-1 ring-inset ring-red-600/20"})},{key:"created_at",label:a("Requested At"),sortable:!0,render:t=>`${window.appSettings.formatDateTime(t,!1)}`}],actions:[{label:a("Approve"),icon:"Check",action:"approve",className:"text-green-600",condition:t=>t.status==="pending",requiredPermission:"approve-plan-requests"},{label:a("Reject"),icon:"X",action:"reject",className:"text-red-600",condition:t=>t.status==="pending",requiredPermission:"reject-plan-requests"}]},search:{placeholder:a("Search plan requests...")},filters:[{key:"status",label:a("Status"),type:"select",options:[{value:"all",label:a("All Status")},{value:"pending",label:a("Pending")},{value:"approved",label:a("Approved")},{value:"rejected",label:a("Rejected")}]}]};function hr(){var x,k,q;const{t}=M(),{flash:X,planRequests:o,filters:l={},auth:g,globalSettings:i}=V().props,w=(g==null?void 0:g.permissions)||[],[n,v]=h.useState(l.search||""),[c,b]=h.useState({}),[F,S]=h.useState(!1);h.useEffect(()=>{var s;const r={};(s=f.filters)==null||s.forEach(e=>{r[e.key]=l[e.key]||""}),b(r)},[]);const _=(r,s)=>{r==="approve"?(i!=null&&i.is_demo||p.loading(t("Approving plan request...")),m.post(route("plan-requests.approve",s.id),{},{onSuccess:e=>{i!=null&&i.is_demo||p.dismiss(),e.props.flash.success?p.success(t(e.props.flash.success)):e.props.flash.error&&p.error(t(e.props.flash.error))},onError:e=>{i!=null&&i.is_demo||p.dismiss(),typeof e=="string"?p.error(e):p.error(`Failed to approve plan request: ${Object.values(e).join(", ")}`)}})):r==="reject"&&(i!=null&&i.is_demo||p.loading(t("Rejecting plan request...")),m.post(route("plan-requests.reject",s.id),{},{onSuccess:e=>{i!=null&&i.is_demo||p.dismiss(),e.props.flash.success?p.success(t(e.props.flash.success)):e.props.flash.error&&p.error(t(e.props.flash.error))},onError:e=>{i!=null&&i.is_demo||p.dismiss(),typeof e=="string"?p.error(e):p.error(`Failed to reject plan request: ${Object.values(e).join(", ")}`)}}))},A=r=>{r.preventDefault(),P()},P=()=>{const r={page:1};n&&(r.search=n),Object.entries(c).forEach(([s,e])=>{e&&e!=="all"&&(r[s]=e)}),l.per_page&&(r.per_page=l.per_page),m.get(route("plan-requests.index"),r,{preserveState:!0,preserveScroll:!0})},C=(r,s)=>{b(y=>({...y,[r]:s}));const e={page:1};n&&(e.search=n);const d={...c,[r]:s};Object.entries(d).forEach(([y,j])=>{j&&j!=="all"&&(e[y]=j)}),l.per_page&&(e.per_page=l.per_page),m.get(route("plan-requests.index"),e,{preserveState:!0,preserveScroll:!0})},E=[{title:t("Dashboard"),href:route("dashboard")},{title:t("Plans"),href:route("plans.index")},{title:t("Plan Requests")}],N=()=>Object.entries(c).some(([r,s])=>s&&s!=="")||n!=="",O=(x=f.table.actions)==null?void 0:x.map(r=>({...r,label:t(r.label)}));return u.jsxs(T,{title:t("Plan Requests"),url:"/plan-requests",breadcrumbs:E,noPadding:!0,children:[u.jsx("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow mb-4 p-4",children:u.jsx(I,{searchTerm:n,onSearchChange:v,onSearch:A,filters:((k=f.filters)==null?void 0:k.map(r=>{var s;return{name:r.key,label:t(r.label),type:"select",value:c[r.key]||"",onChange:e=>C(r.key,e),options:((s=r.options)==null?void 0:s.map(e=>({value:e.value,label:t(e.label)})))||[]}}))||[],showFilters:F,setShowFilters:S,hasActiveFilters:N,activeFilterCount:()=>Object.values(c).filter(r=>r&&r!=="").length+(n?1:0),onResetFilters:()=>{v(""),b({}),m.get(route("plan-requests.index"),{page:1},{preserveState:!0,preserveScroll:!0})},onApplyFilters:P,currentPerPage:((q=l.per_page)==null?void 0:q.toString())||"10",onPerPageChange:r=>{const s={page:1,per_page:parseInt(r)};n&&(s.search=n),Object.entries(c).forEach(([e,d])=>{d&&d!==""&&(s[e]=d)}),m.get(route("plan-requests.index"),s,{preserveState:!0,preserveScroll:!0})}})}),u.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow overflow-hidden",children:[u.jsx(D,{columns:f.table.columns.map(r=>({...r,label:t(r.label)})),actions:O,data:(o==null?void 0:o.data)||[],from:(o==null?void 0:o.from)||1,onAction:_,permissions:w,entityPermissions:f.entity.permissions}),u.jsx(B,{from:(o==null?void 0:o.from)||0,to:(o==null?void 0:o.to)||0,total:(o==null?void 0:o.total)||0,links:o==null?void 0:o.links,entityName:t("plan requests"),onPageChange:r=>m.get(r)})]})]})}export{hr as default};
