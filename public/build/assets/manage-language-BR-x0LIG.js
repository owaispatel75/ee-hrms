import{r as l,j as a}from"./ui-5WRyBZNT.js";import{P as q}from"./page-template-CKIx2Cd4.js";import{u as X,c as B,t as o,n as S,r as b,e as H,C as K,I as w}from"./app-Dcb6Z4yW.js";import{S as I}from"./scroll-area-BNTU7Fcp.js";import{R as _}from"./language-WoaYFWNr.js";import{C as $}from"./CrudDeleteModal-h-4oV4Ln.js";import{B as E}from"./ban-CoJEhB2G.js";import{E as J}from"./eye-BauIsDws.js";import{T as W}from"./trash-2-CeLXIVfe.js";import"./textarea-LYs2mVcU.js";import"./select-DeRz6PSF.js";import"./index-BdQq_4o_.js";import"./index-CCaALC5E.js";import"./trophy-CwLH3bof.js";import"./loader-circle-BHYyy5xm.js";import"./copy-CEvMX_m9.js";import"./CookieConsentBanner-DQyHDBeh.js";import"./switch-t9Hay6Hq.js";import"./chevron-right-D-6n0McF.js";import"./credit-card-DqjaQidM.js";import"./dollar-sign-Cwr3Gu39.js";import"./users-CMrPg0xJ.js";import"./clock-bjnTPlpB.js";import"./calendar-DCWku5XV.js";import"./user-mASyYuwG.js";import"./use-favicon-DuYrl8Bg.js";import"./use-brand-theme-Bndhjp9t.js";/* empty css            *//* empty css                  */import"./utils-BkYo4WJR.js";function Le(){var v,L;const{t:r}=X(),{languages:c,defaultLang:i,defaultData:u,globalSettings:g}=B().props,d=(g==null?void 0:g.is_demo)||!1,[n,D]=l.useState(i),[C,m]=l.useState(u),[T,f]=l.useState(!1),[N,p]=l.useState(!1),[h,F]=l.useState(""),[A,x]=l.useState(!1);l.useEffect(()=>{D(i)},[i]),l.useEffect(()=>{if(n===i&&Object.keys(u).length>0){m(u);return}f(!0),fetch(`${route("language.load")}?lang=${n}`).then(e=>e.json()).then(e=>{e.data?m(e.data):m({}),f(!1)}).catch(()=>{m({}),f(!1),o.error(r("Failed to load language file"))})},[n,i,u,r]);const O=(e,s)=>{m(t=>({...t,[e]:s}))},R=e=>{var s;return e&&e.preventDefault(),p(!0),fetch(route("language.save"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((s=document.querySelector('meta[name="csrf-token"]'))==null?void 0:s.getAttribute("content"))||"",Accept:"application/json","X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({_method:"PATCH",lang:n,data:C})}).then(t=>t.json()).then(t=>{t.success?o.success(t.success):t.error?d&&t.message?o.error(t.message):o.error(t.error):d&&t.message?o.error(t.message):o.success(r("Language updated successfully")),p(!1)}).catch(t=>{console.error("Save error:",t),o.error(r("Failed to update language file")),p(!1)}),!1},k=()=>{var e;fetch(route("languages.toggle",{languageCode:n}),{method:"PATCH",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((e=document.querySelector('meta[name="csrf-token"]'))==null?void 0:e.getAttribute("content"))||"",Accept:"application/json"}}).then(s=>s.json()).then(s=>{s.success?(o.success(s.message||r("Language status updated successfully")),window.location.reload()):d&&s.message?o.error(s.message):o.error(s.error||r("Failed to update language status"))}).catch(s=>{console.error("Error:",s),o.error(r("Failed to update language status"))})},M=()=>{x(!0)},P=()=>{var e;x(!1),fetch(route("languages.delete",{languageCode:n}),{method:"DELETE",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((e=document.querySelector('meta[name="csrf-token"]'))==null?void 0:e.getAttribute("content"))||"",Accept:"application/json"}}).then(s=>s.json()).then(s=>{if(s.success){o.success(s.message||r("Language deleted successfully"));const t=c.filter(j=>j.code!==n),y=t.find(j=>j.code==="en")||t[0];y?b.get(route("manage-language",{lang:y.code})):b.get(route("manage-language"))}else d&&s.message?o.error(s.message):o.error(s.error||r("Failed to delete language"))}).catch(s=>{console.error("Error:",s),o.error(r("Failed to delete language"))})};return a.jsxs(q,{title:r("Manage Language"),description:"Manage language translations",url:"/manage-language",actions:n!=="en"?(()=>{const e=c.find(t=>t.code===n),s=(e==null?void 0:e.enabled)===!1;return[{label:r(s?"Enable Language":"Disable Language"),icon:s?a.jsx(J,{className:"h-4 w-4"}):a.jsx(E,{className:"h-4 w-4"}),variant:s?"secondary":"outline",onClick:k},{label:r("Delete Language"),icon:a.jsx(W,{className:"h-4 w-4"}),variant:"destructive",onClick:M}]})():[],children:[a.jsxs("div",{className:"flex flex-col md:flex-row gap-8",children:[a.jsx("div",{className:"md:w-64 flex-shrink-0",children:a.jsx("div",{className:"sticky top-20",children:a.jsx(I,{className:"h-[calc(100vh-5rem)]",children:a.jsx("div",{className:"pr-4 space-y-1",children:c.map(e=>{const s=e.enabled===!1;return a.jsxs(S,{variant:"ghost",className:H("w-full justify-start",{"bg-muted font-medium":n===e.code,"opacity-60":s}),onClick:()=>{n!==e.code&&b.get(route("manage-language",{lang:e.code}))},children:[e.countryCode&&a.jsx(_,{countryCode:e.countryCode,svg:!0,style:{width:"1.2em",height:"1.2em"}}),a.jsx("span",{className:"flex-1",children:e.name}),s&&a.jsx(E,{className:"h-4 w-4 text-muted-foreground"})]},e.code)})})})})}),a.jsx("div",{className:"flex-1",children:a.jsxs(K,{className:"p-6",children:[a.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between mb-4 gap-2",children:[a.jsxs("h2",{className:"text-lg font-semibold",children:[r("Edit Labels for")," ",(v=c.find(e=>e.code===n))==null?void 0:v.name]}),a.jsx(w,{placeholder:r("Search labels..."),value:h,onChange:e=>F(e.target.value),className:"w-full md:w-72"})]}),T?a.jsx("div",{children:r("Loading...")}):a.jsx("form",{onSubmit:e=>(e.preventDefault(),R(e),!1),children:a.jsxs("div",{className:"space-y-4",children:[a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:Object.entries(C).filter(([e,s])=>e.toLowerCase().includes(h.toLowerCase())||s.toLowerCase().includes(h.toLowerCase())).map(([e,s])=>a.jsxs("div",{className:"flex flex-col gap-1",children:[a.jsx("label",{className:"text-xs text-muted-foreground truncate mb-1",children:e}),a.jsx(w,{className:"w-full",value:s,onChange:t=>O(e,t.target.value)})]},e))}),a.jsx("div",{className:"pt-6 text-right",children:a.jsx(S,{type:"submit",disabled:N,children:N?a.jsxs("span",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"animate-spin h-4 w-4 border-2 border-t-transparent border-primary rounded-full"}),r("Saving...")]}):r("Save Changes")})})]})})]})})]}),a.jsx($,{isOpen:A,onClose:()=>x(!1),onConfirm:P,itemName:((L=c.find(e=>e.code===n))==null?void 0:L.name)||"",entityName:r("Language")})]})}export{Le as default};
